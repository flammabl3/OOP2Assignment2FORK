@page "/reservations"
@using OOP2Assignment2.Services
@using Microsoft.Maui.Controls
@inject ReservationHandler reservationHandler


<div id ="reservationSelect">
    <label>
        Code:
        <input @bind-value='code' />
    </label>

    <label>
        Airline:
        <input @bind-value='airline' />
    </label>

    <label>
        Name
        <input @bind-value='name' />
    </label>

    <Button @onclick="FindReservations">Find Reservations</Button>

</div>

<div class="header">
    <h1>Reservations</h1>
</div>

<div>
    <select @bind=selectedReservationNumber>
        @foreach (Reservation reservation in reservations)
        {
            <option value="@reservation">@reservation</option>
        }
    </select>
</div>

@code {
    private List<Reservation> reservations = new List<Reservation>();
    private string code;
    private string airline;
    private string name;

    Reservation selectedReservation;
    string _selectedReservationNumber;
    string selectedReservationNumber { get { return _selectedReservationNumber; } set { selectedReservationNumber = value; selectedReservation = reservationHandler.FindReservation(_selectedReservationNumber); } }

    protected override void OnInitialized()
    {
        reservationHandler.ReadFromFile();
        code = "Any";
        airline = "Any";
        name = "Any";
        selectedReservation = new Reservation();
    }

    protected void FindReservations()
    {
        reservations = reservationHandler.FindReservation(code, airline, name);
        if (reservations.Count() > 0)
            selectedReservation = reservations[0];
    }
}